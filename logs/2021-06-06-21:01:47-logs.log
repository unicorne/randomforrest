2021-06-06 21:01:47,286 - __main__ - INFO - application started
2021-06-06 21:01:47,286 - __main__ - INFO - Train size: 60000
2021-06-06 21:01:47,287 - __main__ - INFO - Test size: 10000
2021-06-06 21:01:47,288 - __main__ - INFO - Tune parameter: False
2021-06-06 21:01:47,288 - tools - INFO - getting data from mnist_784
2021-06-06 21:02:14,416 - tools - INFO - split data to train and test set
2021-06-06 21:02:16,186 - __main__ - INFO - no parameters tuned
2021-06-06 21:02:16,187 - __main__ - INFO - create and fit model
2021-06-06 21:02:16,189 - __main__ - INFO - initialize model
2021-06-06 21:02:16,189 - __main__ - INFO - fitting model on train data
2021-06-06 21:02:17,901 - __main__ - INFO - Score of model on train set: 0.9990333333333333
2021-06-06 21:02:17,946 - __main__ - INFO - Score of model on test set: 0.9455
2021-06-06 21:02:31,058 - tools - INFO - Classification Report: 
2021-06-06 21:02:31,060 - tools - INFO - {'0': {'precision': 0.961081081081081, 'recall': 0.9747807017543859, 'f1-score': 0.9678824169842133, 'support': 912}, '1': {'precision': 0.9708826205641492, 'recall': 0.9852262234533703, 'f1-score': 0.9780018331805683, 'support': 1083}, '2': {'precision': 0.9239766081871345, 'recall': 0.9498997995991983, 'f1-score': 0.9367588932806323, 'support': 998}, '3': {'precision': 0.9109195402298851, 'recall': 0.9305283757338552, 'f1-score': 0.920619554695063, 'support': 1022}, '4': {'precision': 0.9563106796116505, 'recall': 0.9462055715658021, 'f1-score': 0.951231289232255, 'support': 1041}, '5': {'precision': 0.9394939493949395, 'recall': 0.9163090128755365, 'f1-score': 0.9277566539923954, 'support': 932}, '6': {'precision': 0.9661885245901639, 'recall': 0.9632277834525026, 'f1-score': 0.9647058823529412, 'support': 979}, '7': {'precision': 0.95703125, 'recall': 0.9404990403071017, 'f1-score': 0.9486931268151018, 'support': 1042}, '8': {'precision': 0.9384615384615385, 'recall': 0.9242424242424242, 'f1-score': 0.9312977099236641, 'support': 990}, '9': {'precision': 0.9304435483870968, 'recall': 0.922077922077922, 'f1-score': 0.9262418464626191, 'support': 1001}, 'accuracy': 0.9455, 'macro avg': {'precision': 0.9454789340507638, 'recall': 0.9452996855062098, 'f1-score': 0.9453189206919452, 'support': 10000}, 'weighted avg': {'precision': 0.9455764070500613, 'recall': 0.9455, 'f1-score': 0.9454682401726646, 'support': 10000}}
2021-06-06 21:02:31,099 - tools - INFO - Confusion Report: 
2021-06-06 21:02:31,099 - tools - INFO - [[889, 1, 1, 0, 4, 4, 5, 1, 7, 0], [0, 1067, 5, 3, 0, 1, 0, 1, 4, 2], [7, 4, 948, 11, 3, 3, 1, 9, 11, 1], [2, 5, 23, 951, 0, 14, 0, 9, 13, 5], [1, 3, 5, 1, 985, 1, 5, 2, 2, 36], [7, 2, 6, 40, 3, 854, 7, 0, 10, 3], [10, 3, 5, 1, 5, 10, 943, 0, 1, 1], [2, 10, 17, 4, 8, 1, 1, 980, 3, 16], [3, 2, 14, 19, 5, 13, 11, 3, 915, 5], [4, 2, 2, 14, 17, 8, 3, 19, 9, 923]]
2021-06-06 21:02:31,110 - werkzeug - WARNING -  * Running on all addresses.
   WARNING: This is a development server. Do not use it in a production deployment.
2021-06-06 21:02:31,111 - werkzeug - INFO -  * Running on http://172.18.0.2:5000/ (Press CTRL+C to quit)
2021-06-06 21:02:36,872 - main - ERROR - Exception on / [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.9/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.9/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.9/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/app/main.py", line 109, in get_stats
    tools.confusion_matrix_image(confunction_matrix_stats)
  File "/app/tools.py", line 113, in confusion_matrix_image
    plt.savefig("/app/data/confusion_matrix.jpeg")
  File "/usr/local/lib/python3.9/site-packages/matplotlib/pyplot.py", line 966, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/figure.py", line 3005, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2255, in print_figure
    result = print_method(
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 1669, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 431, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 431, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/_api/deprecation.py", line 431, in wrapper
    return func(*inner_args, **inner_kwargs)
  File "/usr/local/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 584, in print_jpg
    return (Image.fromarray(np.asarray(self.buffer_rgba())[..., :3])
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 2169, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/app/data/confusion_matrix.jpeg'
2021-06-06 21:02:36,887 - werkzeug - INFO - 172.18.0.1 - - [06/Jun/2021 21:02:36] "[35m[1mGET / HTTP/1.1[0m" 500 -
